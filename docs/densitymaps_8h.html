<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SLICER - Simulation LIght conE buildeR: SLICER/densitymaps.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SLICER - Simulation LIght conE buildeR<span id="projectnumber">&#160;2.0</span>
   </div>
   <div id="projectbrief">SLICER: Simulation Light Cone Builder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_43f8965ccfdaa7bc99f2ccac264dcc30.html">SLICER</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">densitymaps.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This file defines the functions related to density map creation, particle mapping, and snapshot handling in the simulation environment.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;valarray&gt;</code><br />
<code>#include &lt;stdexcept&gt;</code><br />
<code>#include &lt;CCfits/CCfits&gt;</code><br />
<code>#include &quot;<a class="el" href="data_8h_source.html">data.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="gadget2io_8h_source.html">gadget2io.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for densitymaps.h:</div>
<div class="dyncontent">
<div class="center"><img src="densitymaps_8h__incl.png" border="0" usemap="#aSLICER_2densitymaps_8h" alt=""/></div>
<map name="aSLICER_2densitymaps_8h" id="aSLICER_2densitymaps_8h">
<area shape="rect" title="This file defines the functions related to density map creation, particle mapping,..." alt="" coords="716,5,882,33"/>
<area shape="rect" title=" " alt="" coords="5,308,81,336"/>
<area shape="poly" title=" " alt="" coords="716,25,581,39,499,52,412,72,324,99,238,134,156,179,82,234,62,263,51,294,46,292,57,260,78,230,153,174,235,129,322,94,411,67,498,47,580,33,715,20"/>
<area shape="rect" title=" " alt="" coords="887,81,972,109"/>
<area shape="poly" title=" " alt="" coords="824,31,895,71,892,75,821,36"/>
<area shape="rect" title=" " alt="" coords="997,81,1100,109"/>
<area shape="poly" title=" " alt="" coords="844,31,990,74,988,79,843,36"/>
<area shape="rect" href="data_8h.html" title="Header with different data structures and how to read them." alt="" coords="515,157,577,184"/>
<area shape="poly" title=" " alt="" coords="778,36,696,83,582,151,579,146,694,79,775,31"/>
<area shape="rect" href="utilities_8h.html" title="Provides a set of utility functions for mathematical operations, conversion utilities,..." alt="" coords="833,232,915,260"/>
<area shape="poly" title=" " alt="" coords="806,32,867,216,862,218,801,34"/>
<area shape="rect" href="gadget2io_8h.html" title="Interfaces for handling Gadget&#45;2 simulation data, including reading snapshot headers,..." alt="" coords="707,81,806,109"/>
<area shape="poly" title=" " alt="" coords="794,35,774,69,769,66,789,32"/>
<area shape="rect" title=" " alt="" coords="114,232,236,260"/>
<area shape="poly" title=" " alt="" coords="515,181,251,233,250,227,514,175"/>
<area shape="rect" title=" " alt="" coords="608,308,670,336"/>
<area shape="poly" title=" " alt="" coords="514,174,419,174,294,181,232,188,177,199,132,214,104,234,98,246,103,258,123,265,168,273,305,289,592,314,592,320,305,294,167,278,122,270,100,262,93,246,100,231,130,210,175,194,231,183,293,175,419,169,514,168"/>
<area shape="rect" title=" " alt="" coords="260,232,333,260"/>
<area shape="poly" title=" " alt="" coords="515,184,348,232,347,227,513,179"/>
<area shape="rect" title=" " alt="" coords="357,232,441,260"/>
<area shape="poly" title=" " alt="" coords="521,187,440,228,437,223,518,182"/>
<area shape="rect" title=" " alt="" coords="465,232,536,260"/>
<area shape="poly" title=" " alt="" coords="540,186,519,220,514,218,535,183"/>
<area shape="rect" title=" " alt="" coords="560,232,625,260"/>
<area shape="poly" title=" " alt="" coords="556,183,578,218,574,221,552,186"/>
<area shape="rect" title=" " alt="" coords="650,232,719,260"/>
<area shape="poly" title=" " alt="" coords="572,183,648,222,645,227,569,187"/>
<area shape="rect" title=" " alt="" coords="744,232,809,260"/>
<area shape="poly" title=" " alt="" coords="578,179,730,227,728,232,576,184"/>
<area shape="rect" title=" " alt="" coords="371,308,451,336"/>
<area shape="poly" title=" " alt="" coords="514,176,276,196,155,213,114,223,93,234,88,246,93,258,110,271,136,283,206,300,285,310,356,316,356,321,284,315,205,305,134,288,107,276,89,262,82,246,89,231,112,218,154,208,276,191,514,171"/>
<area shape="poly" title=" " alt="" coords="578,176,818,229,817,234,577,181"/>
<area shape="poly" title=" " alt="" coords="832,261,821,263,611,289,405,307,96,322,96,316,404,301,611,284,820,257,831,255"/>
<area shape="poly" title=" " alt="" coords="833,263,686,309,684,304,831,258"/>
<area shape="poly" title=" " alt="" coords="833,260,821,263,626,295,466,316,466,311,625,290,820,257,832,255"/>
<area shape="rect" title=" " alt="" coords="761,308,819,336"/>
<area shape="poly" title=" " alt="" coords="860,263,818,300,814,296,857,259"/>
<area shape="rect" title=" " alt="" coords="843,308,905,336"/>
<area shape="poly" title=" " alt="" coords="876,261,876,292,871,292,871,261"/>
<area shape="rect" title=" " alt="" coords="929,308,1045,336"/>
<area shape="poly" title=" " alt="" coords="895,258,956,297,953,302,892,263"/>
<area shape="poly" title=" " alt="" coords="720,112,593,156,591,151,718,107"/>
<area shape="poly" title=" " alt="" coords="761,108,775,217,770,217,755,109"/>
<area shape="poly" title=" " alt="" coords="768,107,856,218,852,222,764,110"/>
</map>
</div>
</div>
<p><a href="densitymaps_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aab8767731a13a97b9ce51d4d460e5af3" id="r_aab8767731a13a97b9ce51d4d460e5af3"><td class="memItemLeft" align="right" valign="top"><a id="aab8767731a13a97b9ce51d4d460e5af3" name="aab8767731a13a97b9ce51d4d460e5af3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_M</b>&#160;&#160;&#160;1e3</td></tr>
<tr class="separator:aab8767731a13a97b9ce51d4d460e5af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27299d488ae8ea3320b038f444a0f037" id="r_a27299d488ae8ea3320b038f444a0f037"><td class="memItemLeft" align="right" valign="top"><a id="a27299d488ae8ea3320b038f444a0f037" name="a27299d488ae8ea3320b038f444a0f037"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DO_NGP</b>&#160;&#160;&#160;false</td></tr>
<tr class="separator:a27299d488ae8ea3320b038f444a0f037"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95af888cd7812be1bf8b68d3164cf49a" id="r_a95af888cd7812be1bf8b68d3164cf49a"><td class="memItemLeft" align="right" valign="top"><a id="a95af888cd7812be1bf8b68d3164cf49a" name="a95af888cd7812be1bf8b68d3164cf49a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>numberOfLensPerSnap</b>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a95af888cd7812be1bf8b68d3164cf49a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a112c14ed0c46f3e74e6ed800c5ff02b5" id="r_a112c14ed0c46f3e74e6ed800c5ff02b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a112c14ed0c46f3e74e6ed800c5ff02b5">getSnap</a> (vector&lt; double &gt; &amp;zsnap, gsl_spline *GetDl, gsl_interp_accel *accGetDl, double dlens)</td></tr>
<tr class="memdesc:a112c14ed0c46f3e74e6ed800c5ff02b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the snapshot index where the computed comoving distance is closest to the specified value.  <br /></td></tr>
<tr class="separator:a112c14ed0c46f3e74e6ed800c5ff02b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50c7db077c0207fff260ead64776d72a" id="r_a50c7db077c0207fff260ead64776d72a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50c7db077c0207fff260ead64776d72a">buildPlanes</a> (<a class="el" href="structInputParams.html">InputParams</a> &amp;p, <a class="el" href="structLens.html">Lens</a> &amp;lens, vector&lt; double &gt; &amp;snapred, vector&lt; string &gt; &amp;snappath, vector&lt; double &gt; &amp;snapbox, gsl_spline *GetDl, gsl_interp_accel *accGetDl, gsl_spline *GetZl, gsl_interp_accel *accGetZl, int numOfLensPerSnap, int myid)</td></tr>
<tr class="memdesc:a50c7db077c0207fff260ead64776d72a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs lens planes based on simulation specifications and input parameters.  <br /></td></tr>
<tr class="separator:a50c7db077c0207fff260ead64776d72a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92d772246c4d8282033e33b729a88e3c" id="r_a92d772246c4d8282033e33b729a88e3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a92d772246c4d8282033e33b729a88e3c">randomizeBox</a> (<a class="el" href="structRandom.html">Random</a> &amp;random, <a class="el" href="structLens.html">Lens</a> &amp;lens, <a class="el" href="structInputParams.html">InputParams</a> &amp;p, int numOfLensPerSnap, int myid)</td></tr>
<tr class="memdesc:a92d772246c4d8282033e33b729a88e3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Randomizes simulation box conditions based on lens planes and input parameters.  <br /></td></tr>
<tr class="separator:a92d772246c4d8282033e33b729a88e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa19e3b6a09ec1fa7e8af0a4ecea9ab7f" id="r_aa19e3b6a09ec1fa7e8af0a4ecea9ab7f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa19e3b6a09ec1fa7e8af0a4ecea9ab7f">computeReplications</a> (double fov, double boxl, double Ds, int myid, double &amp;fovradiants, int &amp;nrepperp)</td></tr>
<tr class="memdesc:aa19e3b6a09ec1fa7e8af0a4ecea9ab7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the number of necessary replications on the perpendicular plane.  <br /></td></tr>
<tr class="separator:aa19e3b6a09ec1fa7e8af0a4ecea9ab7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef32580f12c44c4e5b5c2d736a8b2d1f" id="r_aef32580f12c44c4e5b5c2d736a8b2d1f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aef32580f12c44c4e5b5c2d736a8b2d1f">testFov</a> (double fov, double boxl, double Ds, int myid, double &amp;fovradiants)</td></tr>
<tr class="memdesc:aef32580f12c44c4e5b5c2d736a8b2d1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests if the chosen angular aperture is within allowed limits.  <br /></td></tr>
<tr class="separator:aef32580f12c44c4e5b5c2d736a8b2d1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d32cfccf5edb9fdb33a84603e63345b" id="r_a7d32cfccf5edb9fdb33a84603e63345b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d32cfccf5edb9fdb33a84603e63345b">mapParticles</a> (ifstream &amp;fin, <a class="el" href="structHeader.html">Header</a> &amp;data, <a class="el" href="structInputParams.html">InputParams</a> &amp;p, <a class="el" href="structLens.html">Lens</a> &amp;lens, float *xx[6][3], double fovradiants, int isnap, valarray&lt; float &gt;(&amp;mapxyi)[6], int(&amp;ntotxyi)[6], int myid)</td></tr>
<tr class="memdesc:a7d32cfccf5edb9fdb33a84603e63345b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps particles onto grids using the Triangular Shaped Cloud (TSC) Mass Assignment Scheme (MAS).  <br /></td></tr>
<tr class="separator:a7d32cfccf5edb9fdb33a84603e63345b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa07ec140f5d13d6f13a96addfebffa1" id="r_afa07ec140f5d13d6f13a96addfebffa1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa07ec140f5d13d6f13a96addfebffa1">createDensityMaps</a> (<a class="el" href="structInputParams.html">InputParams</a> &amp;p, <a class="el" href="structLens.html">Lens</a> &amp;lens, <a class="el" href="structRandom.html">Random</a> &amp;random, int isnap, unsigned int ffmin, unsigned int ffmax, string File, double fovradiants, double rcase, gsl_spline *GetDl, gsl_interp_accel *accGetDl, gsl_spline *GetZl, gsl_interp_accel *accGetZl, valarray&lt; float &gt; &amp;mapxytot, valarray&lt; float &gt;(&amp;mapxytoti)[6], int(&amp;ntotxyi)[6], int myid)</td></tr>
<tr class="memdesc:afa07ec140f5d13d6f13a96addfebffa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates density maps by mapping particles onto planes.  <br /></td></tr>
<tr class="separator:afa07ec140f5d13d6f13a96addfebffa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9938ab6defb8d23045f0810ebf529b97" id="r_a9938ab6defb8d23045f0810ebf529b97"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9938ab6defb8d23045f0810ebf529b97">writeMaps</a> (<a class="el" href="structInputParams.html">InputParams</a> &amp;p, <a class="el" href="structHeader.html">Header</a> &amp;data, <a class="el" href="structLens.html">Lens</a> &amp;lens, int isnap, double zsim, string snappl, string snpix, valarray&lt; float &gt; &amp;mapxytotrecv, valarray&lt; float &gt;(&amp;mapxytotirecv)[6], int(&amp;ntotxyi)[6], int myid)</td></tr>
<tr class="memdesc:a9938ab6defb8d23045f0810ebf529b97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes density maps to disk.  <br /></td></tr>
<tr class="separator:a9938ab6defb8d23045f0810ebf529b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb6a63b58a37822277dd1e5c2fe1274" id="r_a7eb6a63b58a37822277dd1e5c2fe1274"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7eb6a63b58a37822277dd1e5c2fe1274">fileOutput</a> (<a class="el" href="structInputParams.html">InputParams</a> p, string snappl, int label=0)</td></tr>
<tr class="memdesc:a7eb6a63b58a37822277dd1e5c2fe1274"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates an output file name based on the simulation parameters and snapshot details.  <br /></td></tr>
<tr class="separator:a7eb6a63b58a37822277dd1e5c2fe1274"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file defines the functions related to density map creation, particle mapping, and snapshot handling in the simulation environment. </p>
<p>It includes functions for generating density maps, handling particle data, randomizing conditions in the simulation box, and utilities for working with comoving distances and snapshot data. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a50c7db077c0207fff260ead64776d72a" name="a50c7db077c0207fff260ead64776d72a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50c7db077c0207fff260ead64776d72a">&#9670;&#160;</a></span>buildPlanes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int buildPlanes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structInputParams.html">InputParams</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>p</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structLens.html">Lens</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>lens</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>snapred</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; string &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>snappath</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>snapbox</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_spline *</td>          <td class="paramname"><span class="paramname"><em>GetDl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_interp_accel *</td>          <td class="paramname"><span class="paramname"><em>accGetDl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_spline *</td>          <td class="paramname"><span class="paramname"><em>GetZl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_interp_accel *</td>          <td class="paramname"><span class="paramname"><em>accGetZl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>numOfLensPerSnap</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>myid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs lens planes based on simulation specifications and input parameters. </p>
<p>This function creates lens planes according to the provided simulation specifications and stores them in the 'lens' structure. It uses various interpolation functions to compute comoving distances and requires paths and redshifts of snapshots.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Reference to the <a class="el" href="structInputParams.html" title="Stores parameters read from an input file for simulation configuration.">InputParams</a> structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">lens</td><td>Reference to the <a class="el" href="structLens.html" title="Represents lensing configuration for the simulation.">Lens</a> structure where the lens planes will be stored. </td></tr>
    <tr><td class="paramname">snapred</td><td>Vector containing the redshifts of the snapshots. </td></tr>
    <tr><td class="paramname">snappath</td><td>Vector containing the paths to the snapshot files. </td></tr>
    <tr><td class="paramname">snapbox</td><td>Vector containing the box sizes for each snapshot (not used in the provided snippet). </td></tr>
    <tr><td class="paramname">GetDl</td><td>GSL spline for comoving distance interpolation. </td></tr>
    <tr><td class="paramname">accGetDl</td><td>GSL interpolation accelerator for GetDl. </td></tr>
    <tr><td class="paramname">GetZl</td><td>GSL spline for redshift interpolation. </td></tr>
    <tr><td class="paramname">accGetZl</td><td>GSL interpolation accelerator for GetZl. </td></tr>
    <tr><td class="paramname">numOfLensPerSnap</td><td>Number of lens planes per snapshot. </td></tr>
    <tr><td class="paramname">myid</td><td>Processor ID for conditional logging. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Status code indicating success or failure of the function. </dd></dl>

</div>
</div>
<a id="aa19e3b6a09ec1fa7e8af0a4ecea9ab7f" name="aa19e3b6a09ec1fa7e8af0a4ecea9ab7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa19e3b6a09ec1fa7e8af0a4ecea9ab7f">&#9670;&#160;</a></span>computeReplications()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void computeReplications </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>fov</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>boxl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>Ds</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>myid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>fovradiants</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;</td>          <td class="paramname"><span class="paramname"><em>nrepperp</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the number of necessary replications on the perpendicular plane. </p>
<p>Calculates how many times the simulation box should be replicated on the plane perpendicular to the lens axis to match the specified field of view, given the dark-energy equation of state parameter w. This is only used if the directive ReplicationOnPerpendicularPlane is enabled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fov</td><td>Field of view in degrees. </td></tr>
    <tr><td class="paramname">boxl</td><td>Box size of the simulation. </td></tr>
    <tr><td class="paramname">Ds</td><td>Comoving distance at source redshift. </td></tr>
    <tr><td class="paramname">myid</td><td>Processor ID for conditional logging. </td></tr>
    <tr><td class="paramname">fovradiants</td><td>Field of view in radians (output parameter). </td></tr>
    <tr><td class="paramname">nrepperp</td><td>Number of replications on the perpendicular plane (output parameter). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afa07ec140f5d13d6f13a96addfebffa1" name="afa07ec140f5d13d6f13a96addfebffa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa07ec140f5d13d6f13a96addfebffa1">&#9670;&#160;</a></span>createDensityMaps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int createDensityMaps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structInputParams.html">InputParams</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>p</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structLens.html">Lens</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>lens</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structRandom.html">Random</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>random</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>isnap</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>ffmin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>ffmax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>File</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>fovradiants</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>rcase</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_spline *</td>          <td class="paramname"><span class="paramname"><em>GetDl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_interp_accel *</td>          <td class="paramname"><span class="paramname"><em>accGetDl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_spline *</td>          <td class="paramname"><span class="paramname"><em>GetZl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_interp_accel *</td>          <td class="paramname"><span class="paramname"><em>accGetZl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">valarray&lt; float &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mapxytot</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">valarray&lt; float &gt;(&amp;)</td>          <td class="paramname"><span class="paramname"><em>mapxytoti</em>[6], </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(&amp;)</td>          <td class="paramname"><span class="paramname"><em>ntotxyi</em>[6], </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>myid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates density maps by mapping particles onto planes. </p>
<p>Utilizes the mapping methodology described in the mapParticles routine to create density maps. This involves interpolating comoving distances and other factors necessary for accurately placing particles onto the simulation grid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Reference to <a class="el" href="structInputParams.html" title="Stores parameters read from an input file for simulation configuration.">InputParams</a> containing the simulation parameters. </td></tr>
    <tr><td class="paramname">lens</td><td>Reference to the <a class="el" href="structLens.html" title="Represents lensing configuration for the simulation.">Lens</a> structure detailing the lens plan. </td></tr>
    <tr><td class="paramname">random</td><td>Reference to <a class="el" href="structRandom.html" title="Holds the parameters for randomizing aspects of the simulation.">Random</a> structure for accessing randomization plans. </td></tr>
    <tr><td class="paramname">isnap</td><td>Index of the current snapshot. </td></tr>
    <tr><td class="paramname">ffmin</td><td>Minimum file frame index. </td></tr>
    <tr><td class="paramname">ffmax</td><td>Maximum file frame index. </td></tr>
    <tr><td class="paramname">File</td><td>Name of the output file. </td></tr>
    <tr><td class="paramname">fovradiants</td><td>Field of view in radians. </td></tr>
    <tr><td class="paramname">rcase</td><td>A case identifier for processing. </td></tr>
    <tr><td class="paramname">GetDl</td><td>GSL spline for comoving distance interpolation. </td></tr>
    <tr><td class="paramname">accGetDl</td><td>GSL interpolation accelerator. </td></tr>
    <tr><td class="paramname">GetZl</td><td>GSL spline for redshift interpolation. </td></tr>
    <tr><td class="paramname">accGetZl</td><td>GSL interpolation accelerator. </td></tr>
    <tr><td class="paramname">mapxytot</td><td>General map for total particle density. </td></tr>
    <tr><td class="paramname">mapxytoti</td><td>Specific maps for different particle densities. </td></tr>
    <tr><td class="paramname">ntotxyi</td><td>Total number of particles mapped. </td></tr>
    <tr><td class="paramname">myid</td><td>Processor ID for logging. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Returns status of the density map creation; 0 on success. </dd></dl>

</div>
</div>
<a id="a7eb6a63b58a37822277dd1e5c2fe1274" name="a7eb6a63b58a37822277dd1e5c2fe1274"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb6a63b58a37822277dd1e5c2fe1274">&#9670;&#160;</a></span>fileOutput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string fileOutput </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structInputParams.html">InputParams</a></td>          <td class="paramname"><span class="paramname"><em>p</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>snappl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>label</em><span class="paramdefsep"> = </span><span class="paramdefval">0</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates an output file name based on the simulation parameters and snapshot details. </p>
<p>This function constructs a filename for output based on various simulation parameters and the specific snapshot being processed, incorporating the provided label if specified.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td><a class="el" href="structInputParams.html" title="Stores parameters read from an input file for simulation configuration.">InputParams</a> structure with current simulation settings. </td></tr>
    <tr><td class="paramname">snappl</td><td>Snapshot path label used as part of the filename. </td></tr>
    <tr><td class="paramname">label</td><td>Optional label to include in </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a112c14ed0c46f3e74e6ed800c5ff02b5" name="a112c14ed0c46f3e74e6ed800c5ff02b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a112c14ed0c46f3e74e6ed800c5ff02b5">&#9670;&#160;</a></span>getSnap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getSnap </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>zsnap</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_spline *</td>          <td class="paramname"><span class="paramname"><em>GetDl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_interp_accel *</td>          <td class="paramname"><span class="paramname"><em>accGetDl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dlens</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the snapshot index where the computed comoving distance is closest to the specified value. </p>
<p>This function reads a vector of snapshot redshifts and identifies the index of the snapshot that has the comoving distance closest to 'dlens'. The comoving distance is calculated using the provided GSL spline interpolation function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">zsnap</td><td>Vector of redshifts for each snapshot. </td></tr>
    <tr><td class="paramname">GetDl</td><td>GSL spline used for interpolating the comoving distance. </td></tr>
    <tr><td class="paramname">accGetDl</td><td>GSL interpolation accelerator for the comoving distance calculation. </td></tr>
    <tr><td class="paramname">dlens</td><td>The target comoving distance to match. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int The index of the snapshot closest to the specified comoving distance. Returns -1 if zsnap is empty. </dd></dl>

</div>
</div>
<a id="a7d32cfccf5edb9fdb33a84603e63345b" name="a7d32cfccf5edb9fdb33a84603e63345b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d32cfccf5edb9fdb33a84603e63345b">&#9670;&#160;</a></span>mapParticles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mapParticles </td>
          <td>(</td>
          <td class="paramtype">ifstream &amp;</td>          <td class="paramname"><span class="paramname"><em>fin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHeader.html">Header</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>data</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structInputParams.html">InputParams</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>p</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structLens.html">Lens</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>lens</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>xx</em>[6][3], </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>fovradiants</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>isnap</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">valarray&lt; float &gt;(&amp;)</td>          <td class="paramname"><span class="paramname"><em>mapxyi</em>[6], </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(&amp;)</td>          <td class="paramname"><span class="paramname"><em>ntotxyi</em>[6], </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>myid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maps particles onto grids using the Triangular Shaped Cloud (TSC) Mass Assignment Scheme (MAS). </p>
<p>This function processes particle data to map them onto specified grids based on their positions and other simulation parameters. If USE_DGP is true, an alternative mapping scheme is used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fin</td><td>Input stream to read particle masses for hydro simulations. </td></tr>
    <tr><td class="paramname">data</td><td>Reference to the <a class="el" href="structHeader.html" title="Represents the header information in a Gadget-2 simulation file.">Header</a> containing simulation specifics. </td></tr>
    <tr><td class="paramname">p</td><td>Reference to <a class="el" href="structInputParams.html" title="Stores parameters read from an input file for simulation configuration.">InputParams</a> containing the simulation parameters. </td></tr>
    <tr><td class="paramname">lens</td><td>Reference to the <a class="el" href="structLens.html" title="Represents lensing configuration for the simulation.">Lens</a> structure detailing the lens plan. </td></tr>
    <tr><td class="paramname">xx</td><td>Arrays containing particle positions. </td></tr>
    <tr><td class="paramname">fovradiants</td><td>The PLC angular aperture in radians. </td></tr>
    <tr><td class="paramname">isnap</td><td>Current snapshot index or number of box repetitions so far. </td></tr>
    <tr><td class="paramname">mapxyi</td><td>Reference to an array to store mapped particle data. </td></tr>
    <tr><td class="paramname">ntotxyi</td><td>Reference to an array counting total particles mapped. </td></tr>
    <tr><td class="paramname">myid</td><td>Processor identifier for conditional logging. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Status of the mapping operation; typically returns 0 if successful. </dd></dl>

</div>
</div>
<a id="a92d772246c4d8282033e33b729a88e3c" name="a92d772246c4d8282033e33b729a88e3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92d772246c4d8282033e33b729a88e3c">&#9670;&#160;</a></span>randomizeBox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void randomizeBox </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRandom.html">Random</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>random</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structLens.html">Lens</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>lens</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structInputParams.html">InputParams</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>p</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>numOfLensPerSnap</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>myid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Randomizes simulation box conditions based on lens planes and input parameters. </p>
<p>Creates a plan for randomizing aspects of the simulation box, such as position and orientation, based on the specified lens planes and stores it in the 'random' structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">random</td><td>Reference to the <a class="el" href="structRandom.html" title="Holds the parameters for randomizing aspects of the simulation.">Random</a> structure to store the randomization plan. </td></tr>
    <tr><td class="paramname">lens</td><td>Reference to the <a class="el" href="structLens.html" title="Represents lensing configuration for the simulation.">Lens</a> structure containing the lens planes. </td></tr>
    <tr><td class="paramname">p</td><td>Reference to the <a class="el" href="structInputParams.html" title="Stores parameters read from an input file for simulation configuration.">InputParams</a> structure containing the simulation parameters. </td></tr>
    <tr><td class="paramname">numOfLensPerSnap</td><td>Number of lens planes per snapshot used for thickness calculations. </td></tr>
    <tr><td class="paramname">myid</td><td>Processor ID for conditional logging. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aef32580f12c44c4e5b5c2d736a8b2d1f" name="aef32580f12c44c4e5b5c2d736a8b2d1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef32580f12c44c4e5b5c2d736a8b2d1f">&#9670;&#160;</a></span>testFov()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int testFov </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>fov</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>boxl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>Ds</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>myid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>fovradiants</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests if the chosen angular aperture is within allowed limits. </p>
<p>This function checks if the specified field of view can be accommodated without needing to replicate the simulation box in the plane parallel to the PLC (Particle Light Cone) axis, which is not allowed by SLICER.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fov</td><td>Field of view in degrees. </td></tr>
    <tr><td class="paramname">boxl</td><td>Length of the simulation box. </td></tr>
    <tr><td class="paramname">Ds</td><td>Comoving distance to the source. </td></tr>
    <tr><td class="paramname">myid</td><td>Processor identifier for logging purposes. </td></tr>
    <tr><td class="paramname">fovradiants</td><td>Output parameter to store the field of view in radians. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Returns 0 if the field of view is allowed, otherwise returns 1. </dd></dl>

</div>
</div>
<a id="a9938ab6defb8d23045f0810ebf529b97" name="a9938ab6defb8d23045f0810ebf529b97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9938ab6defb8d23045f0810ebf529b97">&#9670;&#160;</a></span>writeMaps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeMaps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structInputParams.html">InputParams</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>p</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHeader.html">Header</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>data</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structLens.html">Lens</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>lens</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>isnap</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>zsim</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>snappl</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>snpix</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">valarray&lt; float &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mapxytotrecv</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">valarray&lt; float &gt;(&amp;)</td>          <td class="paramname"><span class="paramname"><em>mapxytotirecv</em>[6], </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(&amp;)</td>          <td class="paramname"><span class="paramname"><em>ntotxyi</em>[6], </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>myid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes density maps to disk. </p>
<p>This function handles the output of density maps created by the mapParticles function to disk. It formats the data appropriately and ensures that all necessary metadata and particle information is correctly encoded.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Input parameters used in the simulation. </td></tr>
    <tr><td class="paramname">data</td><td><a class="el" href="structHeader.html" title="Represents the header information in a Gadget-2 simulation file.">Header</a> information about the simulation. </td></tr>
    <tr><td class="paramname">lens</td><td>Details of the lensing configuration used. </td></tr>
    <tr><td class="paramname">isnap</td><td>Snapshot index used for this operation. </td></tr>
    <tr><td class="paramname">zsim</td><td>Redshift at the simulation time. </td></tr>
    <tr><td class="paramname">snappl</td><td>Path to the snapshot. </td></tr>
    <tr><td class="paramname">snpix</td><td>Pixel label for the output file. </td></tr>
    <tr><td class="paramname">mapxytotrecv</td><td>Array receiving the total mapped densities. </td></tr>
    <tr><td class="paramname">mapxytotirecv</td><td>Arrays receiving specific mapped densities for different types. </td></tr>
    <tr><td class="paramname">ntotxyi</td><td>Total number of particles involved in mapping. </td></tr>
    <tr><td class="paramname">myid</td><td>Processor ID for conditional logging. </td></tr>
  </table>
  </dd>
</dl>
<p>write image array(s) to FITS files each particle type in different planes</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
