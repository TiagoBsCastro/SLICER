<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SLICER - Simulation LIght conE buildeR: SLICER/utilities.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SLICER - Simulation LIght conE buildeR<span id="projectnumber">&#160;2.0</span>
   </div>
   <div id="projectbrief">SLICER: Simulation Light Cone Builder</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_43f8965ccfdaa7bc99f2ccac264dcc30.html">SLICER</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">utilities.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Provides a set of utility functions for mathematical operations, conversion utilities, and handling geometrical transformations useful in simulation data processing.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;gsl/gsl_errno.h&gt;</code><br />
<code>#include &lt;valarray&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for utilities.h:</div>
<div class="dyncontent">
<div class="center"><img src="utilities_8h__incl.png" border="0" usemap="#aSLICER_2utilities_8h" alt=""/></div>
<map name="aSLICER_2utilities_8h" id="aSLICER_2utilities_8h">
<area shape="rect" title="Provides a set of utility functions for mathematical operations, conversion utilities,..." alt="" coords="199,5,331,33"/>
<area shape="rect" title=" " alt="" coords="5,81,85,109"/>
<area shape="poly" title=" " alt="" coords="227,36,100,78,98,73,225,31"/>
<area shape="rect" title=" " alt="" coords="109,81,168,109"/>
<area shape="poly" title=" " alt="" coords="244,36,175,75,172,71,241,31"/>
<area shape="rect" title=" " alt="" coords="191,81,254,109"/>
<area shape="poly" title=" " alt="" coords="260,35,240,69,235,66,255,32"/>
<area shape="rect" title=" " alt="" coords="278,81,340,109"/>
<area shape="poly" title=" " alt="" coords="275,32,296,66,291,69,271,35"/>
<area shape="rect" title=" " alt="" coords="364,81,481,109"/>
<area shape="poly" title=" " alt="" coords="294,31,382,72,380,77,292,36"/>
<area shape="rect" title=" " alt="" coords="505,81,580,109"/>
<area shape="poly" title=" " alt="" coords="315,31,490,77,489,82,314,36"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="utilities_8h__dep__incl.png" border="0" usemap="#aSLICER_2utilities_8hdep" alt=""/></div>
<map name="aSLICER_2utilities_8hdep" id="aSLICER_2utilities_8hdep">
<area shape="rect" title="Provides a set of utility functions for mathematical operations, conversion utilities,..." alt="" coords="274,5,405,33"/>
<area shape="rect" href="data_8h.html" title="Header with different data structures and how to read them." alt="" coords="100,81,211,109"/>
<area shape="poly" title=" " alt="" coords="293,42,189,83,187,78,291,37"/>
<area shape="rect" href="densitymaps_8h.html" title="This file defines the functions related to density map creation, particle mapping,..." alt="" coords="174,232,340,260"/>
<area shape="poly" title=" " alt="" coords="350,47,356,77,359,113,356,150,345,186,334,201,320,215,289,234,287,230,316,211,330,198,340,183,351,149,354,113,351,78,345,48"/>
<area shape="rect" href="gadget2io_8h.html" title="Interfaces for handling Gadget&#45;2 simulation data, including reading snapshot headers,..." alt="" coords="183,157,330,184"/>
<area shape="poly" title=" " alt="" coords="328,47,266,157,262,155,323,45"/>
<area shape="rect" href="w0waCDM_8h.html" title="Class to model the universe using the w0waCDM cosmological model." alt="" coords="405,81,556,109"/>
<area shape="poly" title=" " alt="" coords="379,38,457,78,455,83,377,43"/>
<area shape="poly" title=" " alt="" coords="85,115,51,128,22,143,14,152,9,162,9,172,15,183,39,199,78,213,174,232,173,238,76,218,36,204,11,186,4,173,4,160,9,149,19,139,48,123,84,110"/>
<area shape="poly" title=" " alt="" coords="187,116,240,154,237,158,184,120"/>
<area shape="rect" href="writeplc_8h.html" title="Provides functionality for writing processed halo data to a binary output file formatted specifically..." alt="" coords="24,157,159,184"/>
<area shape="poly" title=" " alt="" coords="136,122,105,158,101,154,132,119"/>
<area shape="poly" title=" " alt="" coords="259,200,259,232,254,232,254,200"/>
</map>
</div>
</div>
<p><a href="utilities_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a80293a294a9bf8ee45bd0e8439f4a8ce" id="r_a80293a294a9bf8ee45bd0e8439f4a8ce"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a80293a294a9bf8ee45bd0e8439f4a8ce"><td class="memTemplItemLeft" align="right" valign="top">string&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a80293a294a9bf8ee45bd0e8439f4a8ce">sconv</a> (T &amp;val, const char *fact)</td></tr>
<tr class="memdesc:a80293a294a9bf8ee45bd0e8439f4a8ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a value of any type to a formatted string based on the provided format specifier.  <br /></td></tr>
<tr class="separator:a80293a294a9bf8ee45bd0e8439f4a8ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7f26c320e0a0a37f8a7c54df0317515" id="r_ae7f26c320e0a0a37f8a7c54df0317515"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae7f26c320e0a0a37f8a7c54df0317515">weight</a> (float ixx, float ixh, double dx)</td></tr>
<tr class="memdesc:ae7f26c320e0a0a37f8a7c54df0317515"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the mass assignment weight using the Triangular Shaped Cloud (TSC) kernel.  <br /></td></tr>
<tr class="separator:ae7f26c320e0a0a37f8a7c54df0317515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa46fba35bb875142bae91040b8ccbe93" id="r_aa46fba35bb875142bae91040b8ccbe93"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa46fba35bb875142bae91040b8ccbe93">getPolar</a> (double x, double y, double z, double &amp;ang1, double &amp;ang2, double &amp;d, bool radec)</td></tr>
<tr class="memdesc:aa46fba35bb875142bae91040b8ccbe93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts Cartesian coordinates to polar coordinates or celestial coordinates (RA, Dec).  <br /></td></tr>
<tr class="separator:aa46fba35bb875142bae91040b8ccbe93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af510a59f98b0d336508c25a6bf113b1d" id="r_af510a59f98b0d336508c25a6bf113b1d"><td class="memItemLeft" align="right" valign="top">valarray&lt; float &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af510a59f98b0d336508c25a6bf113b1d">gridist_w</a> (vector&lt; float &gt;, vector&lt; float &gt;, vector&lt; float &gt;, int, bool)</td></tr>
<tr class="memdesc:af510a59f98b0d336508c25a6bf113b1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Distributes mass to a grid based on particle positions and weights using different mass assignment schemes.  <br /></td></tr>
<tr class="separator:af510a59f98b0d336508c25a6bf113b1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a94b6da9feb81b61930b5ccbcce62f19f" id="r_a94b6da9feb81b61930b5ccbcce62f19f"><td class="memItemLeft" align="right" valign="top"><a id="a94b6da9feb81b61930b5ccbcce62f19f" name="a94b6da9feb81b61930b5ccbcce62f19f"></a>
constexpr double&#160;</td><td class="memItemRight" valign="bottom"><b>speedcunit</b> = 2.99792458e+3</td></tr>
<tr class="separator:a94b6da9feb81b61930b5ccbcce62f19f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides a set of utility functions for mathematical operations, conversion utilities, and handling geometrical transformations useful in simulation data processing. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa46fba35bb875142bae91040b8ccbe93" name="aa46fba35bb875142bae91040b8ccbe93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa46fba35bb875142bae91040b8ccbe93">&#9670;&#160;</a></span>getPolar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getPolar </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>y</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>z</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>ang1</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>ang2</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;</td>          <td class="paramname"><span class="paramname"><em>d</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>radec</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts Cartesian coordinates to polar coordinates or celestial coordinates (RA, Dec). </p>
<p>This function converts Cartesian coordinates (x, y, z) to either polar coordinates (theta, phi, d) or celestial coordinates (Right Ascension, Declination, distance) based on the 'radec' flag.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The x-coordinate in Cartesian coordinates. </td></tr>
    <tr><td class="paramname">y</td><td>The y-coordinate in Cartesian coordinates. </td></tr>
    <tr><td class="paramname">z</td><td>The z-coordinate in Cartesian coordinates. </td></tr>
    <tr><td class="paramname">ang1</td><td>Reference to the output angle 1; theta or RA depending on 'radec'. </td></tr>
    <tr><td class="paramname">ang2</td><td>Reference to the output angle 2; phi or Dec depending on 'radec'. </td></tr>
    <tr><td class="paramname">d</td><td>Reference to the output distance from the origin. </td></tr>
    <tr><td class="paramname">radec</td><td>If true, calculates Right Ascension (RA) and Declination (Dec); if false, calculates theta and phi.</td></tr>
  </table>
  </dd>
</dl>
<p>The function computes the distance 'd' as the Euclidean distance from the origin to the point (x, y, z). Depending on the 'radec' flag, it calculates either:</p><ul>
<li>Polar coordinates:<ul>
<li>Theta (ang1) as the angle from the positive z-axis.</li>
<li>Phi (ang2) as the angle from the positive x-axis in the x-y plane.</li>
</ul>
</li>
<li>Celestial coordinates:<ul>
<li>Right Ascension (ang1) from the y-z plane.</li>
<li>Declination (ang2) as the angle from the equatorial plane. </li>
</ul>
</li>
</ul>

</div>
</div>
<a id="af510a59f98b0d336508c25a6bf113b1d" name="af510a59f98b0d336508c25a6bf113b1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af510a59f98b0d336508c25a6bf113b1d">&#9670;&#160;</a></span>gridist_w()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">valarray&lt; float &gt; gridist_w </td>
          <td>(</td>
          <td class="paramtype">vector&lt; float &gt;</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; float &gt;</td>          <td class="paramname"><span class="paramname"><em>y</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; float &gt;</td>          <td class="paramname"><span class="paramname"><em>w</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nn</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>do_NGP</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Distributes mass to a grid based on particle positions and weights using different mass assignment schemes. </p>
<p>This function computes the distribution of mass onto a grid with specified dimensions. Particles are assigned to the grid based on their positions (<code>x</code>, <code>y</code>) and weights (<code>w</code>). The mass assignment can either be direct to the nearest grid point (NGP) if <code>do_NGP</code> is true, or distributed to neighboring points using a TSC weight function if <code>do_NGP</code> is false. The function ensures particles are properly assigned within the bounds of the grid, and that position and weight arrays are correctly matched in length.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>Vector of x positions for particles, normalized between 0 and 1. </td></tr>
    <tr><td class="paramname">y</td><td>Vector of y positions for particles, corresponding to <code>x</code>. </td></tr>
    <tr><td class="paramname">w</td><td>Vector of weights for each particle. </td></tr>
    <tr><td class="paramname">nn</td><td>The number of grid points per dimension (grid is nn x nn). </td></tr>
    <tr><td class="paramname">do_NGP</td><td>Boolean flag to use Nearest Grid Point (NGP) method; if false, uses a TSC weight function for distribution. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>valarray&lt;float&gt; A flat array representing the 2D grid, where mass values are assigned according to the particle weights and positions.</dd></dl>
<h2><a class="anchor" id="autotoc_md1"></a>
Grid Distribution Details</h2>
<p>The mass is distributed on a 2D grid based on the specified positions and weights:</p><ul>
<li><b>NGP Mode</b>: Directly assigns the full weight of each particle to the nearest grid point.</li>
<li><b>Weighted Mode</b>: Assigns mass to a 3x3 block of grid points centered on the nearest point, adjusted by the weight function which accounts for the distance from each grid point to the actual particle position.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2"></a>
Error Handling</h2>
<p>Throws runtime errors if the lengths of <code>x</code>, <code>y</code>, and <code>w</code> do not match, ensuring data consistency. </p>

</div>
</div>
<a id="a80293a294a9bf8ee45bd0e8439f4a8ce" name="a80293a294a9bf8ee45bd0e8439f4a8ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80293a294a9bf8ee45bd0e8439f4a8ce">&#9670;&#160;</a></span>sconv()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">string sconv </td>
          <td>(</td>
          <td class="paramtype">T &amp;</td>          <td class="paramname"><span class="paramname"><em>val</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>fact</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a value of any type to a formatted string based on the provided format specifier. </p>
<p>This template function takes a value of a generic type T and converts it into a string according to the specified format. It utilizes sprintf to perform the formatting, which allows for precise control over the output format, similar to printf syntax. This function is useful for creating formatted strings from numerical or other data types dynamically.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>The type of the value to be converted into a string. Can be any type that is compatible with the sprintf format specifiers. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">val</td><td>Reference to the value to be converted into a string. </td></tr>
    <tr><td class="paramname">fact</td><td>The format specifier as a C-style string, which determines the formatting of the output string. It should be compatible with the type T (e.g., "%d" for integers, "%f" for floating-point numbers). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string A string object containing the formatted representation of 'val'.</dd></dl>
<p>Example usage: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> number = 42;</div>
<div class="line">std::string result = <a class="code hl_function" href="#a80293a294a9bf8ee45bd0e8439f4a8ce">sconv</a>(number, <span class="stringliteral">&quot;%d&quot;</span>);  <span class="comment">// result will be &quot;42&quot;</span></div>
<div class="line"><span class="keywordtype">double</span> pi = 3.14159;</div>
<div class="line">std::string pi_str = <a class="code hl_function" href="#a80293a294a9bf8ee45bd0e8439f4a8ce">sconv</a>(pi, <span class="stringliteral">&quot;%.2f&quot;</span>);    <span class="comment">// pi_str will be &quot;3.14&quot;</span></div>
<div class="ttc" id="autilities_8h_html_a80293a294a9bf8ee45bd0e8439f4a8ce"><div class="ttname"><a href="#a80293a294a9bf8ee45bd0e8439f4a8ce">sconv</a></div><div class="ttdeci">string sconv(T &amp;val, const char *fact)</div><div class="ttdoc">Converts a value of any type to a formatted string based on the provided format specifier.</div><div class="ttdef"><b>Definition</b> utilities.h:61</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md0"></a>
Note:</h2>
<p>Ensure that the format specifier matches the type of the value being formatted to avoid runtime errors. Be aware of buffer overflow risks associated with sprintf and ensure that the format string and the buffer size are properly managed. </p>

</div>
</div>
<a id="ae7f26c320e0a0a37f8a7c54df0317515" name="ae7f26c320e0a0a37f8a7c54df0317515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7f26c320e0a0a37f8a7c54df0317515">&#9670;&#160;</a></span>weight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float weight </td>
          <td>(</td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>ixx</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>ixh</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the mass assignment weight using the Triangular Shaped Cloud (TSC) kernel. </p>
<p>This function computes the weight for a particle relative to a grid point based on the distance between them, using the TSC kernel. The TSC kernel is a piecewise quadratic function that effectively assigns mass to grid points based on particle proximity, within a specified range.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ixx</td><td>The actual position of the particle. </td></tr>
    <tr><td class="paramname">ixh</td><td>The position of the grid point. </td></tr>
    <tr><td class="paramname">dx</td><td>The grid spacing, which defines the scale of the kernel. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>float The calculated weight according to the TSC kernel. If the distance exceeds the range of influence defined by the kernel, the weight will be zero.</dd></dl>
<p>The weight is determined based on the relative distance between the particle and the grid point, scaled by the grid spacing:</p><ul>
<li>If the distance is less than or equal to 0.5 times the grid spacing, the weight is calculated as: <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\frac{3}{4} - x^2$" src="form_0.png" width="35" height="16"/></picture>, where <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$x$" src="form_1.png" width="8" height="6"/></picture> is the scaled distance.</li>
<li>For distances greater than 0.5 times and up to 1.5 times the grid spacing, the weight follows a quadratic drop-off: <picture><source srcset="form_2_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$0.5 \times (\frac{3}{2} - x)^2$" src="form_2.png" width="78" height="16"/></picture>.</li>
<li>Beyond 1.5 times the grid spacing, the weight is 0, indicating no contribution to the grid point. </li>
</ul>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
